function initMap(){ko.applyBindings(new AppViewModel);var e={lat:47.8104922,lng:-122.248259};map=new google.maps.Map(document.getElementById("map"),{zoom:8,center:e}),filterList(),setupLocMarker()}function AppViewModel(){searchStreet=ko.observable(""),displayLocations=ko.observableArray()}function filterList(){ko.computed(function(){var e=searchStreet().toLowerCase();if(e)ko.utils.arrayFilter(locations,function(n){var t=n.name.toLowerCase(),i=t.search(e)>=0;n.visible=i});else for(var n=0;n<locations.length;n++)locations[n].visible=!0;hideAndShowMarker()},this)}function hideAndShowMarker(){displayLocations.removeAll();for(var e=0;e<locMarker.length;e++)locations[e].visible?locMarker[e].setMap(map):locMarker[e].setMap(null),displayLocations.push(locations[e])}function setupLocMarker(){locMarker=[];for(var e=0;e<locations.length;e++){var n=locations[e];setupInfoWindow(n,new google.maps.Marker({position:n,map:map,title:n.name}),locMarker,e)}}function setupInfoWindow(e,n,t){var i="https://api.foursquare.com/v2/venues/search?client_id="+clientId+"&client_secret="+clientSecret+"&v=20130815&ll="+e.lat+","+e.lng+"&query="+e.name,a={};$.getJSON(i).done(function(t){var i=t.response.venues[0];a.url=i.url,a.street=i.location.formattedAddress[0],a.city=i.location.formattedAddress[1],a.phone=i.contact.phone;var o="<div><h3>"+e.name+"</h3><div>url: "+a.url+"</div><div>street: "+a.street+"</div><div>city: "+a.city+"</div><div>phone: "+a.phone+"</div><div>latitude: "+e.lat+"</div><div>longitude: "+e.lng+"</div></div>",l=new google.maps.InfoWindow({content:o});n.infowindow=l,n.addListener("click",toggleBounce),n.setMap(map),e.marker=n,locMarker[e.index]=n,displayLocations.push(e)}).fail(function(){alert("There was an error with the Foursquare API call. Please Try again later.")})}function locationsListClicked(e){toggleBounce.call(e.marker)}function toggleBounce(){null!==this.getAnimation()?this.setAnimation(null):(this.setAnimation(google.maps.Animation.BOUNCE),this.infowindow.open(map,this))}function errorHandling(){alert("Google Maps has failed to load. Please try again.")}function gm_authFailure(){errorHandling()}function errorHandling(){alert("Google Maps has failed to load. Please try again.")}function openNav(){document.getElementById("mySidenav").style.width="250px"}function closeNav(){document.getElementById("mySidenav").style.width="0"}var locations=[{name:"Seattle Public Library-Central Library",lat:47.6067006,lng:-122.3325009,visible:!0,index:0},{name:"Tacoma Done",lat:47.2366694,lng:-122.4270299,visible:!0,index:1},{name:"Microsoft Corporation",lat:47.5556769,lng:-122.0495224,visible:!0,index:2},{name:"Mount Rainier National Park",lat:46.8799663,lng:-121.7269094,visible:!0,index:3},{name:"Seattle Premium Outlets",lat:48.093531,lng:-122.188311,visible:!0,index:4}],clientId="KX5QOHCVYDOBKYCFM2FT3U5GXUOPKEAW20UUNBBTXYF11H44",clientSecret="U52N3NALZIHQSKJVA3NFXZTTUKZLCHA0JAUW5KNSE2OSAD5X",locMarker=[],searchStreet,map;